<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../components/upload-file/upload-file.html">

<dom-module id="hypervideo-composer-area">
  <style is="custom-style">
  #backcanvas {
    position: absolute;
    top: 75px;
    bottom: 10px;
    left: 10px;
    right: 10px;
  }
  #backcanvas canvas{
    width: 100%;
    height: 100%;
    background-color:rgba(246,246,246,1);/*var(--light-divider-color);*/
  }
  .options {
    position: relative;
    width: 100%;
  }
  #hypervideoName {
    width: 70%;
    margin: 0 10px;
    float: left;
  }
  #toggleDrawer,
  #closeButton {
    float: right;
    max-width: 30px;
    width: 20%;
    font-size: 12px;
  }
  .box {
    display: flex;
    flex-direction: column;
    height: 100%;
  }
  .box .row.content {
    flex: 1 .01 auto;
    overflow: scroll;
  }
  .box .row.footer {
    flex: 0 1 auto;
    min-height: 80px;
    overflow: hidden;
  }
  #fileInputArea {
    color: transparent;
    position: relative;
    width: 100%;
    height: 100%;
    background-color:rgba(220,220,220,0);/*var(--light-divider-color);*/
    overflow: hidden;
  }
  #inputfile{
    opacity: 0;
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: 2;
  }
  #hint-text {
    position: absolute;
    left: 10px;
    top: 10px;
    right: 10px;
    bottom: 10px;
    background-color:rgba(220,220,220,0.2);/*var(--light-divider-color);*/
    color: rgba(200,200,200,1);/*var(--light-divider-color);*/
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    z-index: 0;
  }
  #hint-text span {
    position: absolute;
    width: 200px;
    left: 50%;
    top: 50%;
    margin:-20px 0 0 -100px;
  }
  </style>
  <template>
    <paper-drawer-panel id=drawer>
      <div drawer>
        <div class="box">
          <div class="row content">
            <!-- Here will be displayed uploaded videos -->
            <template id="files" is="dom-repeat" items="{{fileObjects}}" as="videoFile">
              <upload-file file="{{videoFile}}" on-upload-complete="log"></upload-file>
            </template>
          </div>
          <div id="fileInputArea"
            class="row footer"
            on-tap="composerTap">
            <input id="inputfile"
              type="file" multiple
              accept="video/*"
              on-change="loadFiles">
            </input>
            <div id="hint-text">
              <span>
                Clique para fazer upload de v√≠deos
              </span>
            </div>
          </div>
        </div>
      </div>
      <div main>
        <div class="options">
          <paper-button id="closeButton"
          dialog-confirm autofocus>Fechar</paper-button>
          <paper-input id="hypervideoName"
            name="name"
            label="Nome do Hypervideo"
            on-change="_updateHypervideo">
          </paper-input>
          <paper-button id="toggleDrawer"
          on-tap="toggleDrawer">videos</paper-button>
        </div>
        <div id="backcanvas">
          <canvas id="canvas"></canvas>
        </div>
        <!-- this is where subvideos will be displayed -->
      </div>
    </paper-drawer-panel>
  </template>
  <script>
    Polymer({
//============================= Polymer Methods ==============================//
      is: 'hypervideo-composer-area',
      properties: {
        fileObjects: {
          type: Array,
          value: function() {
              return [];
          }
        },
        filesProgress: {
          type: Array,
        },
        // property that holds the model element: a Hypervideo
        hypervideo: {
          type: Object,
          value: null,
        }
      },
      ready: function() {
        this.firstTouch = true;
        this.$.drawer.forceNarrow = true;
        this.$.drawer.openDrawer();
      },
//============================= Public Methods ===============================//
      log: function(e) {
        console.log("completou!!");
      },
      composerTap: function(e) {
      },
      toggleDrawer: function() {
        this.$.drawer.togglePanel();
      },
      loadFiles: function(e) {
        this.files = e.target.files;
        this.fire('upload-videos');
      },
    });
  </script>
</dom-module>
